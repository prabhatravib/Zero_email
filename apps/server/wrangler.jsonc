{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "infflow-api-production",
  "account_id": "5d42835376e52c0332f76de9f9877fc8",
  "compatibility_date": "2025-05-01",
  "compatibility_flags": ["nodejs_compat"],
  "main": "src/main.ts",
  "observability": {
    "enabled": true,
    "logs": {
      "enabled": true
    }
  },
  "d1_databases": [
    {
      "binding": "DB",
      "database_name": "zero-email-demo",
      "database_id": "c4a56b0c-911a-4b90-ac0c-0061e9f6da32"
    }
  ],
  "hyperdrive": [
    {
      "binding": "HYPERDRIVE",
      "id": "d405f5f77f174d5a970bf4ec35a1be59"
    }
  ],
  "ai": {
    "binding": "AI",
  },
  "vectorize": [
    {
      "binding": "VECTORIZE",
      "index_name": "threads-vector",
    },
    {
      "binding": "VECTORIZE_MESSAGE",
      "index_name": "messages-vector",
    },
  ],
  "durable_objects": {
    "bindings": [
      {
        "name": "ZERO_AGENT",
        "class_name": "ZeroAgent",
      },
      {
        "name": "ZERO_MCP",
        "class_name": "ZeroMCP",
      },
      {
        "name": "ZERO_DB",
        "class_name": "ZeroDB",
      },
      {
        "name": "ZERO_DRIVER",
        "class_name": "ZeroDriver",
      },
      {
        "name": "THINKING_MCP",
        "class_name": "ThinkingMCP",
      },
      {
        "name": "WORKFLOW_RUNNER",
        "class_name": "WorkflowRunner",
      },
    ],
  },
  "kv_namespaces": [
    {
      "binding": "gmail_history_id",
      "id": "b44f19d549e74cf8a6b277ca176479b1",
    },
    {
      "binding": "gmail_processing_threads",
      "id": "bfb34c9256f0419ba4cc035bf672fea6",
    },
    {
      "binding": "subscribed_accounts",
      "id": "ca0f0a63f8384dd99140ae522f926f4f",
    },
    {
      "binding": "connection_labels",
      "id": "9e8d7f79bb4c4871b780838950ba7e32",
    },
    {
      "binding": "prompts_storage",
      "id": "5d5271041b654598a16891e97532e67e",
    },
    {
      "binding": "gmail_sub_age",
      "id": "a5a116a808654759a9b0cb6e53b06534",
    },
    {
      "binding": "snoozed_emails",
      "id": "fd52df19f84b49fb99ea084812551dc4",
    },
  ],
  "queues": {
    "producers": [
      {
        "queue": "subscribe-queue",
        "binding": "subscribe_queue",
      },
    ],
    "consumers": [
      {
        "queue": "subscribe-queue",
      },
    ],
  },
    "vars": {
    "NODE_ENV": "production",
    "COOKIE_DOMAIN": "prabhatravib.workers.dev",
    "CORS_ALLOW_ORIGIN": "https://infflow-email.prabhatravib.workers.dev",
    "VITE_PUBLIC_BACKEND_URL": "https://infflow-api-production.prabhatravib.workers.dev",
    "VITE_PUBLIC_APP_URL": "https://infflow-email.prabhatravib.workers.dev",
    "JWT_SECRET": "egwrgwrgndnznzgnfhnzxdgnnethzhnzhtyjtudi5e6u4u75tei6",
    "BETTER_AUTH_SECRET": "49d9590f973b565d9786857ff9b1c74a764a8fd33c832c2f3d08cd0768e55398",
    "DISABLE_CALLS": "true",
    "DROP_AGENT_TABLES": "false",
    "THREAD_SYNC_MAX_COUNT": "10",
    "THREAD_SYNC_LOOP": "true",
    "DISABLE_WORKFLOWS": "true",
    "TWILIO_ACCOUNT_SID": "dummy",
    "TWILIO_AUTH_TOKEN": "dummy",
    "TWILIO_PHONE_NUMBER": "10000000000",
    "GOOGLE_CLIENT_ID": "363401296279-vo7al766jmct0gcat24rrn2grv2jh1p5.apps.googleusercontent.com",
    "GOOGLE_CLIENT_SECRET": "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",
    "AUTUMN_SECRET_KEY": "dummy",
    "MICROSOFT_CLIENT_ID": "your_microsoft_client_id_here",
    "MICROSOFT_CLIENT_SECRET": "your_microsoft_client_secret_here",
    "OPENAI_API_KEY": "sk-proj-dummy-key-for-poc-testing",
    "ELEVENLABS_API_KEY": "1234567890",
    "VOICE_SECRET": "1234567890",
    "USE_OPENAI": "true",
    "AUTORAG_ID": "",
    "CLOUDFLARE_ACCOUNT_ID": "5d42835376e52c0332f76de9f9877fc8",
    "DATABASE_URL": "postgresql://postgres:postgres@localhost:5432/zerodotemail"
  },
  // Removed migrations to avoid conflicts with existing Durable Objects
  // The code now handles SQLite unavailability gracefully
  "env": {
    "local": {
      "migrations_dir": "src/db/migrations",
      "d1_databases": [
        {
          "binding": "DB",
          "database_name": "zero-email-local",
          "database_id": "3ad0192a-0c8b-44c6-9f21-c02e435bd7e7"
        }
      ],
      "hyperdrive": [
        {
          "binding": "HYPERDRIVE",
          "id": "57834ddb6716440496c8836f6d99bc9a",
          "localConnectionString": "postgresql://postgres:postgres@127.0.0.1:5432/zerodotemail",
        },
      ],
      "ai": {
        "binding": "AI",
      },
      "vectorize": [
        {
          "binding": "VECTORIZE",
          "index_name": "threads-vector-staging",
        },
        {
          "binding": "VECTORIZE_MESSAGE",
          "index_name": "messages-vector-staging",
        },
      ],
      "r2_buckets": [
        {
          "binding": "THREADS_BUCKET",
          "bucket_name": "threads-staging",
        },
      ],
      "durable_objects": {
        "bindings": [
          {
            "name": "ZERO_AGENT",
            "class_name": "ZeroAgent",
          },
          {
            "name": "ZERO_MCP",
            "class_name": "ZeroMCP",
          },
          {
            "name": "ZERO_DB",
            "class_name": "ZeroDB",
          },
          {
            "name": "ZERO_DRIVER",
            "class_name": "ZeroDriver",
          },
          {
            "name": "THINKING_MCP",
            "class_name": "ThinkingMCP",
          },
          {
            "name": "WORKFLOW_RUNNER",
            "class_name": "WorkflowRunner",
          },
        ],
      },
      "queues": {
        "producers": [
          {
            "queue": "thread-queue",
            "binding": "thread_queue",
          },
          {
            "queue": "subscribe-queue",
            "binding": "subscribe_queue",
          },
        ],
        "consumers": [
          {
            "queue": "subscribe-queue",
          },
          {
            "queue": "thread-queue",
          },
        ],
      },
      "migrations": [
        {
          "tag": "v1",
          "new_classes": ["DurableMailbox"],
        },
        {
          "tag": "v2",
          "new_sqlite_classes": ["ZeroAgent", "ZeroMCP"],
        },
        {
          "tag": "v3",
          "new_classes": ["ZeroDB"],
        },
        {
          "tag": "v4",
          "deleted_classes": ["DurableMailbox"],
        },
        {
          "tag": "v5",
          "new_sqlite_classes": ["ZeroDriver"],
        },
        {
          "tag": "v6",
          "new_sqlite_classes": ["ThinkingMCP"],
        },
        {
          "tag": "v7",
          "new_sqlite_classes": ["WorkflowRunner"],
        },
      ],

      "observability": {
        "enabled": true,
        "logs": {
          "enabled": true
        }
      },
      "triggers": {
        "crons": ["*/1 * * * *"],
      },
      "hyperdrive": [
        {
          "binding": "HYPERDRIVE",
          "id": "57834ddb6716440496c8836f6d99bc9a",
          "localConnectionString": "postgresql://postgres:postgres@127.0.0.1:5432/zerodotemail",
        },
      ],
      "vars": {
        "NODE_ENV": "local",
        "COOKIE_DOMAIN": "localhost",
        "CORS_ALLOW_ORIGIN": "http://localhost:3000",
        "VITE_PUBLIC_BACKEND_URL": "http://localhost:8787",
        "VITE_PUBLIC_APP_URL": "http://localhost:3000",
        "JWT_SECRET": "secret",
        "ELEVENLABS_API_KEY": "1234567890",
        "DISABLE_CALLS": "true",
        "VOICE_SECRET": "1234567890",
        "GOOGLE_S_ACCOUNT": "{}",
        "DROP_AGENT_TABLES": "false",
        "THREAD_SYNC_MAX_COUNT": "5",
        "THREAD_SYNC_LOOP": "false",
        "DISABLE_WORKFLOWS": "true",
        "AUTORAG_ID": "",
        "USE_OPENAI": "true",
        "TWILIO_ACCOUNT_SID": "dummy",
        "TWILIO_AUTH_TOKEN": "dummy",
        "TWILIO_PHONE_NUMBER": "10000000000",
        "CLOUDFLARE_ACCOUNT_ID": "5d42835376e52c0332f76de9f9877fc8",
        "GOOGLE_CLIENT_ID": "363401296279-vo7al766jmct0gcat24rrn2grv2jh1p5.apps.googleusercontent.com",
        "GOOGLE_CLIENT_SECRET": "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",

      },
      "kv_namespaces": [
        {
          "binding": "gmail_history_id",
          "id": "4e814c70e35d413d99c923029928efae",
        },
        {
          "binding": "gmail_processing_threads",
          "id": "b7db3a98a80f4e16a8b6edc5fa8c7b76",
        },
        {
          "binding": "subscribed_accounts",
          "id": "7e6eadacf19c4c56a9ec3c357adb584a",
        },
        {
          "binding": "connection_labels",
          "id": "4d3a28d3265a4388aae2e9e9b534d019",
        },
        {
          "binding": "prompts_storage",
          "id": "620e710aaea744e59df4788f9ec18ff9",
        },
        {
          "binding": "gmail_sub_age",
          "id": "c55e692bb71d4e5bae23dded092b09d5",
        },
        {
          "binding": "snoozed_emails",
          "id": "f3a30ed7198542d890db172536bade33",
        },
      ],
    },
    "staging": {
      "triggers": {
        "crons": ["0 0 * * *"],
      },
      "ai": {
        "binding": "AI",
      },
      "vectorize": [
        {
          "binding": "VECTORIZE",
          "index_name": "threads-vector-staging",
        },
        {
          "binding": "VECTORIZE_MESSAGE",
          "index_name": "messages-vector-staging",
        },
      ],
      "limits": {
        "cpu_ms": 300000,
      },
      "durable_objects": {
        "bindings": [
          {
            "name": "ZERO_AGENT",
            "class_name": "ZeroAgent",
          },
          {
            "name": "ZERO_MCP",
            "class_name": "ZeroMCP",
          },
          {
            "name": "ZERO_DB",
            "class_name": "ZeroDB",
          },
          {
            "name": "ZERO_DRIVER",
            "class_name": "ZeroDriver",
          },
          {
            "name": "THINKING_MCP",
            "class_name": "ThinkingMCP",
          },
          {
            "name": "WORKFLOW_RUNNER",
            "class_name": "WorkflowRunner",
          },
        ],
      },
      "r2_buckets": [
        {
          "binding": "THREADS_BUCKET",
          "bucket_name": "threads-staging",
        },
      ],
      // Queues removed for free plan compatibility
      "migrations": [
        {
          "tag": "v1",
          "new_classes": ["DurableMailbox"],
        },
        {
          "tag": "v2",
          "new_sqlite_classes": ["ZeroAgent", "ZeroMCP"],
        },
        {
          "tag": "v3",
          "new_classes": ["ZeroDB"],
        },
        {
          "tag": "v4",
          "new_sqlite_classes": ["ZeroAgent"],
        },
        {
          "tag": "v5",
          "deleted_classes": ["DurableMailbox"],
        },
        {
          "tag": "v6",
          "new_sqlite_classes": ["ZeroDriver"],
        },
        {
          "tag": "v7",
          "new_sqlite_classes": ["ThinkingMCP"],
        },
        {
          "tag": "v8",
          "new_sqlite_classes": ["WorkflowRunner"],
        },
      ],
      "observability": {
        "enabled": true,
        "logs": {
          "enabled": true
        }
      },
      "hyperdrive": [
        {
          "binding": "HYPERDRIVE",
          "id": "57834ddb6716440496c8836f6d99bc9a",
          "localConnectionString": "postgresql://postgres:gkKY4b29iaueBdfxVHjC@pitext-email-demo.cqr2cig2sg3q.us-east-1.rds.amazonaws.com:5432/postgres?sslmode=require",
        },
      ],
      "vars": {
        "NODE_ENV": "development",
        "COOKIE_DOMAIN": "0.email",
        "VITE_PUBLIC_BACKEND_URL": "https://sapi.0.email",
        "VITE_PUBLIC_APP_URL": "https://staging.0.email",
        "DISABLE_CALLS": "",
        "DROP_AGENT_TABLES": "false",
        "THREAD_SYNC_MAX_COUNT": "20",
        "THREAD_SYNC_LOOP": "true",
        "DISABLE_WORKFLOWS": "true",
        "TWILIO_ACCOUNT_SID": "dummy",
        "TWILIO_AUTH_TOKEN": "dummy",
        "TWILIO_PHONE_NUMBER": "10000000000",
      },
      "kv_namespaces": [
        {
          "binding": "gmail_history_id",
          "id": "4e814c70e35d413d99c923029928efae",
        },
        {
          "binding": "gmail_processing_threads",
          "id": "b7db3a98a80f4e16a8b6edc5fa8c7b76",
        },
        {
          "binding": "subscribed_accounts",
          "id": "7e6eadacf19c4c56a9ec3c357adb584a",
        },
        {
          "binding": "connection_labels",
          "id": "4d3a28d3265a4388aae2e9e9b534d019",
        },
        {
          "binding": "prompts_storage",
          "id": "620e710aaea744e59df4788f9ec18ff9",
        },
        {
          "binding": "gmail_sub_age",
          "id": "c55e692bb71d4e5bae23dded092b09d5",
        },
        {
          "binding": "snoozed_emails",
          "id": "f3a30ed7198542d890db172536bade33",
        },
      ],
    },
    "production": {
      "d1_databases": [
        {
          "binding": "DB",
          "database_name": "zero-email-demo",
          "database_id": "c4a56b0c-911a-4b90-ac0c-0061e9f6da32"
        }
      ],
      "triggers": {
        "crons": ["0 0 * * *"],
      },
      // R2 buckets removed for free plan compatibility
      "ai": {
        "binding": "AI",
      },
      "vectorize": [
        {
          "binding": "VECTORIZE",
          "index_name": "threads-vector",
        },
        {
          "binding": "VECTORIZE_MESSAGE",
          "index_name": "messages-vector",
        },
      ],
      "observability": {
        "enabled": true,
        "logs": {
          "enabled": true
        }
      },
      "hyperdrive": [
        {
          "binding": "HYPERDRIVE",
          "id": "d405f5f77f174d5a970bf4ec35a1be59",
          "localConnectionString": "postgresql://postgres:gkKY4b29iaueBdfxVHjC@pitext-email-demo.cqr2cig2sg3q.us-east-1.rds.amazonaws.com:5432/postgres?sslmode=require",
        },
      ],
      "durable_objects": {
        "bindings": [
          {
            "name": "ZERO_AGENT",
            "class_name": "ZeroAgent",
          },
          {
            "name": "ZERO_MCP",
            "class_name": "ZeroMCP",
          },
          {
            "name": "ZERO_DB",
            "class_name": "ZeroDB",
          },
          {
            "name": "ZERO_DRIVER",
            "class_name": "ZeroDriver",
          },
          {
            "name": "THINKING_MCP",
            "class_name": "ThinkingMCP",
          },
          {
            "name": "WORKFLOW_RUNNER",
            "class_name": "WorkflowRunner",
          },
        ],
      },
      // Queues removed for free plan compatibility
      // Removed migrations to avoid conflicts with existing Durable Objects
      // The code now handles SQLite unavailability gracefully
      "migrations_dir": "src/db/migrations",
      "vars": {
        "NODE_ENV": "production",
        "COOKIE_DOMAIN": "prabhatravib.workers.dev",
        "CORS_ALLOW_ORIGIN": "https://infflow-email.prabhatravib.workers.dev",
        "VITE_PUBLIC_BACKEND_URL": "https://infflow-api-production.prabhatravib.workers.dev",
        "VITE_PUBLIC_APP_URL": "https://infflow-email.prabhatravib.workers.dev",
        "JWT_SECRET": "egwrgwrgndnznzgnfhnzxdgnnethzhnzhtyjtudi5e6u4u75tei6",
        "BETTER_AUTH_SECRET": "49d9590f973b565d9786857ff9b1c74a764a8fd33c832c2f3d08cd0768e55398",
        "DISABLE_CALLS": "true",
        "DROP_AGENT_TABLES": "false",
        "THREAD_SYNC_MAX_COUNT": "10",
        "THREAD_SYNC_LOOP": "true",
        "DISABLE_WORKFLOWS": "true",
        "TWILIO_ACCOUNT_SID": "dummy",
        "TWILIO_AUTH_TOKEN": "dummy",
        "TWILIO_PHONE_NUMBER": "10000000000",
        "GOOGLE_CLIENT_ID": "363401296279-vo7al766jmct0gcat24rrn2grv2jh1p5.apps.googleusercontent.com",
        "GOOGLE_CLIENT_SECRET": "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",
        "AUTUMN_SECRET_KEY": "dummy",
      },
      "kv_namespaces": [
        {
          "binding": "gmail_history_id",
          "id": "b44f19d549e74cf8a6b277ca176479b1",
        },
        {
          "binding": "gmail_processing_threads",
          "id": "bfb34c9256f0419ba4cc035bf672fea6",
        },
        {
          "binding": "subscribed_accounts",
          "id": "ca0f0a63f8384dd99140ae522f926f4f",
        },
        {
          "binding": "connection_labels",
          "id": "9e8d7f79bb4c4871b780838950ba7e32",
        },
        {
          "binding": "prompts_storage",
          "id": "5d5271041b654598a16891e97532e67e",
        },
        {
          "binding": "gmail_sub_age",
          "id": "a5a116a808654759a9b0cb6e53b06534",
        },
        {
          "binding": "snoozed_emails",
          "id": "fd52df19f84b49fb99ea084812551dc4",
        },
      ],
    },
  },
}
